.TH "OC ADM" "1" " Openshift CLI User Manuals" "Openshift" "June 2016"  ""


.SH NAME
.PP
oc adm router \- Install a router


.SH SYNOPSIS
.PP
\fBoc adm router\fP [OPTIONS]


.SH DESCRIPTION
.PP
Install or configure a router

.PP
This command helps to setup a router to take edge traffic and balance it to your application. With no arguments, the command will check for an existing router service called 'router' and create one if it does not exist. If you want to test whether a router has already been created add the \-\-dry\-run flag and the command will exit with 1 if the registry does not exist.

.PP
If a router does not exist with the given name, this command will create a deployment configuration and service that will run the router. If you are running your router in production, you should pass \-\-replicas=2 or higher to ensure you have failover protection.


.SH OPTIONS
.PP
\fB\-\-ciphers\fP=""
    Specifies the cipher suites to use. You can choose a predefined cipher set ('modern', 'intermediate', or 'old') or specify exact cipher suites by passing a : separated list. Not supported for F5.

.PP
\fB\-\-create\fP=false
    deprecated; this is now the default behavior

.PP
\fB\-\-default\-cert\fP=""
    Optional path to a certificate file that be used as the default certificate.  The file should contain the cert, key, and any CA certs necessary for the router to serve the certificate. Does not apply to external appliance based routers (e.g. F5)

.PP
\fB\-\-disable\-namespace\-ownership\-check\fP=false
    Disables the namespace ownership check and allows different namespaces to claim either different paths to a route host or overlapping host names in case of a wildcard route. The default behavior (false) to restrict claims to the oldest namespace that has claimed either the host or the subdomain. Please be aware that if namespace ownership checks are disabled, routes in a different namespace can use this mechanism to 'steal' sub\-paths for existing domains. This is only safe if route creation privileges are restricted, or if all the users can be trusted.

.PP
\fB\-\-dry\-run\fP=false
    If true, show the result of the operation without performing it.

.PP
\fB\-\-extended\-logging\fP=false
    If true, then configure the router with additional logging.

.PP
\fB\-\-external\-host\fP=""
    If the underlying router implementation connects with an external host, this is the external host's hostname.

.PP
\fB\-\-external\-host\-http\-vserver\fP=""
    If the underlying router implementation uses virtual servers, this is the name of the virtual server for HTTP connections.

.PP
\fB\-\-external\-host\-https\-vserver\fP=""
    If the underlying router implementation uses virtual servers, this is the name of the virtual server for HTTPS connections.

.PP
\fB\-\-external\-host\-insecure\fP=false
    If the underlying router implementation connects with an external host over a secure connection, this causes the router to skip strict certificate verification with the external host.

.PP
\fB\-\-external\-host\-internal\-ip\fP=""
    If the underlying router implementation requires the use of a specific network interface to connect to the pod network, this is the IP address of that internal interface.

.PP
\fB\-\-external\-host\-partition\-path\fP=""
    If the underlying router implementation uses partitions for control boundaries, this is the path to use for that partition.

.PP
\fB\-\-external\-host\-password\fP=""
    If the underlying router implementation connects with an external host, this is the password for authenticating with the external host.

.PP
\fB\-\-external\-host\-private\-key\fP=""
    If the underlying router implementation requires an SSH private key, this is the path to the private key file.

.PP
\fB\-\-external\-host\-username\fP=""
    If the underlying router implementation connects with an external host, this is the username for authenticating with the external host.

.PP
\fB\-\-external\-host\-vxlan\-gw\fP=""
    If the underlying router implementation requires VxLAN access to the pod network, this is the gateway address that should be used in cidr format.

.PP
\fB\-\-force\-subdomain\fP=""
    A router path format to force on all routes used by this router (will ignore the route host value)

.PP
\fB\-\-host\-network\fP=true
    If true (the default), then use host networking rather than using a separate container network stack. Not required for external appliance based routers (e.g. F5)

.PP
\fB\-\-host\-ports\fP=true
    If true (the default), when not using host networking host ports will be exposed. Not required for external appliance based routers (e.g. F5)

.PP
\fB\-\-images\fP="openshift/origin\-${component}:${version}"
    The image to base this router on \- ${component} will be replaced with \-\-type

.PP
\fB\-\-labels\fP="router=<name>"
    A set of labels to uniquely identify the router and its components.

.PP
\fB\-\-latest\-images\fP=false
    If true, attempt to use the latest images for the router instead of the latest release.

.PP
\fB\-\-local\fP=false
    If true, do not contact the apiserver

.PP
\fB\-\-max\-connections\fP=""
    Specifies the maximum number of concurrent connections. Not supported for F5.

.PP
\fB\-\-mutual\-tls\-auth\fP="none"
    Controls access to the router using mutually agreed upon TLS configuration (example client certificates). You can choose one of 'required', 'optional', or 'none'. The default is none.

.PP
\fB\-\-mutual\-tls\-auth\-ca\fP=""
    Optional path to a file containing one or more CA certificates used for mutual TLS authentication. The CA certificate[s] are used by the router to verify a client's certificate.

.PP
\fB\-\-mutual\-tls\-auth\-crl\fP=""
    Optional path to a file containing the certificate revocation list used for mutual TLS authentication. The certificate revocation list is used by the router to verify a client's certificate.

.PP
\fB\-\-mutual\-tls\-auth\-filter\fP=""
    Optional regular expression to filter the client certificates. If the client certificate subject field does \fInot\fP match this regular expression, requests will be rejected by the router.

.PP
\fB\-o\fP, \fB\-\-output\fP=""
    Output results as yaml or json instead of executing, or use name for succint output (resource/name).

.PP
\fB\-\-output\-version\fP=""
    The preferred API versions of the output objects

.PP
\fB\-\-ports\fP="80:80,443:443"
    A comma delimited list of ports or port pairs that set the port in the router pod containerPort and hostPort. It also sets service port and targetPort to expose on the router pod. This does not modify the env variables. That can be done using oc set env or by editing the router's dc. This is used when host\-network=false.

.PP
\fB\-\-replicas\fP=1
    The replication factor of the router; commonly 2 when high availability is desired.

.PP
\fB\-\-router\-canonical\-hostname\fP=""
    CanonicalHostname is the external host name for the router that can be used as a CNAME for the host requested for this route. This value is optional and may not be set in all cases.

.PP
\fB\-\-secrets\-as\-env\fP=false
    If true, use environment variables for master secrets.

.PP
\fB\-\-selector\fP=""
    Selector used to filter nodes on deployment. Used to run routers on a specific set of nodes.

.PP
\fB\-\-service\-account\fP="router"
    Name of the service account to use to run the router pod.

.PP
\fB\-a\fP, \fB\-\-show\-all\fP=true
    When printing, show all resources (false means hide terminated pods.)

.PP
\fB\-\-show\-labels\fP=false
    When printing, show all labels as the last column (default hide labels column)

.PP
\fB\-\-sort\-by\fP=""
    If non\-empty, sort list types using this field specification.  The field specification is expressed as a JSONPath expression (e.g. '{.metadata.name}'). The field in the API resource specified by this JSONPath expression must be an integer or a string.

.PP
\fB\-\-stats\-password\fP=""
    If the underlying router implementation can provide statistics this is the requested password for auth.  If not set a password will be generated. Not available for external appliance based routers (e.g. F5)

.PP
\fB\-\-stats\-port\fP=1936
    If the underlying router implementation can provide statistics this is a hint to expose it on this port. Specify 0 if you want to turn off exposing the statistics.

.PP
\fB\-\-stats\-user\fP="admin"
    If the underlying router implementation can provide statistics this is the requested username for auth. Not available for external appliance based routers (e.g. F5)

.PP
\fB\-\-strict\-sni\fP=false
    Use strict\-sni bind processing (do not use default cert). Not supported for F5.

.PP
\fB\-\-subdomain\fP=""
    The template for the route subdomain exposed by this router, used for routes that are not externally specified. E.g. '${name}\-${namespace}.apps.mycompany.com'

.PP
\fB\-\-template\fP=""
    Template string or path to template file to use when \-o=go\-template, \-o=go\-template\-file. The template format is golang templates [
\[la]http://golang.org/pkg/text/template/#pkg-overview\[ra]].

.PP
\fB\-\-threads\fP=0
    Specifies the number of threads for the haproxy router.

.PP
\fB\-\-type\fP="haproxy\-router"
    The type of router to use \- if you specify \-\-images this flag may be ignored.


.SH OPTIONS INHERITED FROM PARENT COMMANDS
.PP
\fB\-\-allow\_verification\_with\_non\_compliant\_keys\fP=false
    Allow a SignatureVerifier to use keys which are technically non\-compliant with RFC6962.

.PP
\fB\-\-alsologtostderr\fP=false
    log to standard error as well as files

.PP
\fB\-\-application\_metrics\_count\_limit\fP=100
    Max number of application metrics to store (per container)

.PP
\fB\-\-as\fP=""
    Username to impersonate for the operation

.PP
\fB\-\-as\-group\fP=[]
    Group to impersonate for the operation, this flag can be repeated to specify multiple groups.

.PP
\fB\-\-azure\-container\-registry\-config\fP=""
    Path to the file containing Azure container registry configuration information.

.PP
\fB\-\-boot\_id\_file\fP="/proc/sys/kernel/random/boot\_id"
    Comma\-separated list of files to check for boot\-id. Use the first one that exists.

.PP
\fB\-\-cache\-dir\fP="/home/openshift/.kube/http\-cache"
    Default HTTP cache directory

.PP
\fB\-\-certificate\-authority\fP=""
    Path to a cert file for the certificate authority

.PP
\fB\-\-client\-certificate\fP=""
    Path to a client certificate file for TLS

.PP
\fB\-\-client\-key\fP=""
    Path to a client key file for TLS

.PP
\fB\-\-cloud\-provider\-gce\-lb\-src\-cidrs\fP=130.211.0.0/22,209.85.152.0/22,209.85.204.0/22,35.191.0.0/16
    CIDRs opened in GCE firewall for LB traffic proxy \& health checks

.PP
\fB\-\-cluster\fP=""
    The name of the kubeconfig cluster to use

.PP
\fB\-\-container\_hints\fP="/etc/cadvisor/container\_hints.json"
    location of the container hints file

.PP
\fB\-\-containerd\fP="unix:///var/run/containerd.sock"
    containerd endpoint

.PP
\fB\-\-context\fP=""
    The name of the kubeconfig context to use

.PP
\fB\-\-default\-not\-ready\-toleration\-seconds\fP=300
    Indicates the tolerationSeconds of the toleration for notReady:NoExecute that is added by default to every pod that does not already have such a toleration.

.PP
\fB\-\-default\-unreachable\-toleration\-seconds\fP=300
    Indicates the tolerationSeconds of the toleration for unreachable:NoExecute that is added by default to every pod that does not already have such a toleration.

.PP
\fB\-\-docker\fP="unix:///var/run/docker.sock"
    docker endpoint

.PP
\fB\-\-docker\-tls\fP=false
    use TLS to connect to docker

.PP
\fB\-\-docker\-tls\-ca\fP="ca.pem"
    path to trusted CA

.PP
\fB\-\-docker\-tls\-cert\fP="cert.pem"
    path to client certificate

.PP
\fB\-\-docker\-tls\-key\fP="key.pem"
    path to private key

.PP
\fB\-\-docker\_env\_metadata\_whitelist\fP=""
    a comma\-separated list of environment variable keys that needs to be collected for docker containers

.PP
\fB\-\-docker\_only\fP=false
    Only report docker containers in addition to root stats

.PP
\fB\-\-docker\_root\fP="/var/lib/docker"
    DEPRECATED: docker root is read from docker info (this is a fallback, default: /var/lib/docker)

.PP
\fB\-\-enable\_load\_reader\fP=false
    Whether to enable cpu load reader

.PP
\fB\-\-event\_storage\_age\_limit\fP="default=24h"
    Max length of time for which to store events (per type). Value is a comma separated list of key values, where the keys are event types (e.g.: creation, oom) or "default" and the value is a duration. Default is applied to all non\-specified event types

.PP
\fB\-\-event\_storage\_event\_limit\fP="default=100000"
    Max number of events to store (per type). Value is a comma separated list of key values, where the keys are event types (e.g.: creation, oom) or "default" and the value is an integer. Default is applied to all non\-specified event types

.PP
\fB\-\-global\_housekeeping\_interval\fP=0
    Interval between global housekeepings

.PP
\fB\-\-housekeeping\_interval\fP=0
    Interval between container housekeepings

.PP
\fB\-\-httptest.serve\fP=""
    if non\-empty, httptest.NewServer serves on this address and blocks

.PP
\fB\-\-insecure\-skip\-tls\-verify\fP=false
    If true, the server's certificate will not be checked for validity. This will make your HTTPS connections insecure

.PP
\fB\-\-kubeconfig\fP=""
    Path to the kubeconfig file to use for CLI requests.

.PP
\fB\-\-log\-flush\-frequency\fP=0
    Maximum number of seconds between log flushes

.PP
\fB\-\-log\_backtrace\_at\fP=:0
    when logging hits line file:N, emit a stack trace

.PP
\fB\-\-log\_cadvisor\_usage\fP=false
    Whether to log the usage of the cAdvisor container

.PP
\fB\-\-log\_dir\fP=""
    If non\-empty, write log files in this directory

.PP
\fB\-\-logtostderr\fP=true
    log to standard error instead of files

.PP
\fB\-\-machine\_id\_file\fP="/etc/machine\-id,/var/lib/dbus/machine\-id"
    Comma\-separated list of files to check for machine\-id. Use the first one that exists.

.PP
\fB\-\-match\-server\-version\fP=false
    Require server version to match client version

.PP
\fB\-n\fP, \fB\-\-namespace\fP=""
    If present, the namespace scope for this CLI request

.PP
\fB\-\-request\-timeout\fP="0"
    The length of time to wait before giving up on a single server request. Non\-zero values should contain a corresponding time unit (e.g. 1s, 2m, 3h). A value of zero means don't timeout requests.

.PP
\fB\-s\fP, \fB\-\-server\fP=""
    The address and port of the Kubernetes API server

.PP
\fB\-\-stderrthreshold\fP=2
    logs at or above this threshold go to stderr

.PP
\fB\-\-storage\_driver\_buffer\_duration\fP=0
    Writes in the storage driver will be buffered for this duration, and committed to the non memory backends as a single transaction

.PP
\fB\-\-storage\_driver\_db\fP="cadvisor"
    database name

.PP
\fB\-\-storage\_driver\_host\fP="localhost:8086"
    database host:port

.PP
\fB\-\-storage\_driver\_password\fP="root"
    database password

.PP
\fB\-\-storage\_driver\_secure\fP=false
    use secure connection with database

.PP
\fB\-\-storage\_driver\_table\fP="stats"
    table name

.PP
\fB\-\-storage\_driver\_user\fP="root"
    database username

.PP
\fB\-\-token\fP=""
    Bearer token for authentication to the API server

.PP
\fB\-\-user\fP=""
    The name of the kubeconfig user to use

.PP
\fB\-v\fP, \fB\-\-v\fP=0
    log level for V logs

.PP
\fB\-\-version\fP=false
    Print version information and quit

.PP
\fB\-\-vmodule\fP=
    comma\-separated list of pattern=N settings for file\-filtered logging


.SH EXAMPLE
.PP
.RS

.nf
  # Check the default router ("router")
  oc adm router \-\-dry\-run
  
  # See what the router would look like if created
  oc adm router \-o yaml
  
  # Create a router with two replicas if it does not exist
  oc adm router router\-west \-\-replicas=2
  
  # Use a different router image
  oc adm router region\-west \-\-images=myrepo/somerouter:mytag
  
  # Run the router with a hint to the underlying implementation to \_not\_ expose statistics.
  oc adm router router\-west \-\-stats\-port=0

.fi
.RE


.SH SEE ALSO
.PP
\fBoc\-adm(1)\fP,


.SH HISTORY
.PP
June 2016, Ported from the Kubernetes man\-doc generator
